{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/a99/localDocuments/codeBase/ideaWorkplace/reacttest/frontend/src/lib/auth.ts"],"sourcesContent":["// Authentication utilities for JWT token management and permission verification\nimport axios from 'axios';\n\n// API base URL used for frontend-to-backend requests.\n// Prefer reading from environment variable NEXT_PUBLIC_API_BASE_URL so you can easily switch between dev/staging/prod.\n// Fallback to Spring Boot's common default port (8080) when not provided.\n//设置默认请求地址为localhost:8080/api\nconst API_BASE_URL = (typeof process !== 'undefined' && process.env.NEXT_PUBLIC_API_BASE_URL)\n  ? `${process.env.NEXT_PUBLIC_API_BASE_URL}/api`\n  : 'http://localhost:8080/api';\n\nexport interface User {\n  id: string;\n  username: string;\n  name: string;\n  email: string;\n  role: 'admin' | 'operator' | 'viewer';\n  department?: string;\n  permissions: string[];\n  avatar?: string;\n}\n\nexport interface AuthState {\n  isAuthenticated: boolean;\n  user: User | null;\n  token: string | null;\n}\n\n// Role-based permissions mapping\nexport const ROLE_PERMISSIONS = {\n  admin: [\n    'user:read', 'user:write', 'user:delete',\n    'device:read', 'device:write', 'device:delete',\n    'project:read', 'project:write', 'project:delete',\n    'service:read', 'service:write', 'service:delete',\n    'monitoring:read', 'monitoring:write',\n    'alert:read', 'alert:write', 'alert:delete',\n    'system:read', 'system:write'\n  ],\n  operator: [\n    'user:read',\n    'device:read', 'device:write',\n    'project:read', 'project:write',\n    'service:read', 'service:write',\n    'monitoring:read',\n    'alert:read', 'alert:write'\n  ],\n  viewer: [\n    'user:read',\n    'device:read',\n    'project:read',\n    'service:read',\n    'monitoring:read',\n    'alert:read'\n  ]\n};\n\n// Token management\nexport class AuthManager {\n  private static readonly TOKEN_KEY = 'auth_token';\n  private static readonly USER_KEY = 'auth_user';\n  private static readonly REFRESH_TOKEN_KEY = 'refresh_token';\n\n  // Get stored token\n  static getToken(): string | null {\n    if (typeof window === 'undefined') return null;\n    return localStorage.getItem(this.TOKEN_KEY);\n  }\n\n  // Set token\n  static setToken(token: string): void {\n    if (typeof window === 'undefined') return;\n    localStorage.setItem(this.TOKEN_KEY, token);\n  }\n\n  // Remove token\n  static removeToken(): void {\n    if (typeof window === 'undefined') return;\n    localStorage.removeItem(this.TOKEN_KEY);\n    localStorage.removeItem(this.USER_KEY);\n    localStorage.removeItem(this.REFRESH_TOKEN_KEY);\n  }\n\n  // Get stored user\n  static getUser(): User | null {\n    if (typeof window === 'undefined') return null;\n    const userStr = localStorage.getItem(this.USER_KEY);\n    if (!userStr) return null;\n    \n    try {\n      const user = JSON.parse(userStr);\n      // Add permissions based on role\n      user.permissions = ROLE_PERMISSIONS[user.role as keyof typeof ROLE_PERMISSIONS] || [];\n      return user;\n    } catch {\n      return null;\n    }\n  }\n\n  // Set user\n  static setUser(user: User): void {\n    if (typeof window === 'undefined') return;\n    localStorage.setItem(this.USER_KEY, JSON.stringify(user));\n  }\n\n  // Check if token is expired\n  /**\n   * Check if a JWT token is expired.\n   * This version is defensive: if the token is not a valid JWT (e.g., a mock token without three parts),\n   * it will assume the token is NOT expired to avoid accidental logout in demo mode.\n   *\n   * Why: Our backend's mock /signin returns \"mock-jwt-token\" for testing, which is not a real JWT,\n   * and the previous implementation would treat it as expired immediately.\n   */\n  static isTokenExpired(token: string): boolean {\n    try {\n      const parts = token.split('.');\n      // If token is not in JWT format (header.payload.signature), treat it as not expired\n      if (parts.length !== 3) {\n        return false;\n      }\n      const payload = JSON.parse(atob(parts[1]));\n      const currentTime = Date.now() / 1000;\n      // If payload.exp exists and is a number, compare with current time; otherwise assume not expired\n      return typeof payload.exp === 'number' ? payload.exp < currentTime : false;\n    } catch {\n      // On any parsing error, assume not expired to keep user logged in\n      return false;\n    }\n  }\n\n  // Check if user is authenticated\n  static isAuthenticated(): boolean {\n    const token = this.getToken();\n    if (!token) return false;\n    \n    if (this.isTokenExpired(token)) {\n      this.removeToken();\n      return false;\n    }\n    \n    return true;\n  }\n\n  // Get current auth state\n  static getAuthState(): AuthState {\n    const token = this.getToken();\n    const user = this.getUser();\n    const isAuthenticated = this.isAuthenticated();\n    \n    return {\n      isAuthenticated,\n      user: isAuthenticated ? user : null,\n      token: isAuthenticated ? token : null\n    };\n  }\n\n  // Login\n  /**\n   * Perform login by calling backend API and storing JWT + user info locally.\n   *\n   * Flow:\n   * 1) Try POST `${API_BASE_URL}/auth/signin` with { username, password }.\n   *    - Expected response (JwtResponseDto): { token, type, id, username, email, roles }\n   *    - Save token to localStorage; map backend roles (e.g., ROLE_ADMIN/ROLE_OPERATOR/ROLE_USER)\n   *      to our app roles ('admin' | 'operator' | 'viewer') and assign permissions.\n   * 2) If /auth/signin fails (e.g., backend not ready), fall back to POST `${API_BASE_URL}/auth/login`.\n   *    - This endpoint returns a simple success flag. We'll store a mock token and basic user info so\n   *      the rest of the app can run for demo/testing.\n   *\n   * Returns: { success, message, user? }\n   */\n  static async login(username: string, password: string): Promise<{ success: boolean; message: string; user?: User }> {\n    try {\n      // Attempt real signin endpoint first\n      //使用axios发送POST请求 \n      const res = await axios.post(`${API_BASE_URL}/auth/signin`, {\n        username,\n        password\n      }, {\n        headers: { 'Content-Type': 'application/json' }\n      });\n\n      const data: any = res.data || {};\n      const token: string | undefined = data.token;\n\n      // 2.1) 如果后端没有返回 token，视为失败并给出清晰的提示（这在联调早期很常见）\n      if (!token) {\n        return { success: false, message: 'Login failed: token is missing in server response.' };\n      }\n\n      // 2.2) 角色数组（如 [\"ROLE_USER\", \"ROLE_ADMIN\"]），用于前端权限映射\n      const roles: string[] = Array.isArray(data.roles) ? data.roles : [];\n\n      // Map backend roles to frontend roles used in our app\n      const mappedRole: 'admin' | 'operator' | 'viewer' =\n        roles.includes('ROLE_ADMIN') ? 'admin' :\n        roles.includes('ROLE_OPERATOR') ? 'operator' :\n        'viewer';\n\n      const user: User = {\n        id: String(data.id ?? '1'),\n        username: data.username ?? username,\n        name: data.username ?? username,\n        email: data.email ?? `${username}@example.com`,\n        role: mappedRole,\n        permissions: ROLE_PERMISSIONS[mappedRole]\n      };\n\n      // Persist token and user\n      this.setToken(token);\n      this.setUser(user);\n\n      return { success: true, message: 'Login successful', user };\n    } catch (error: any) {\n      // 捕获失败并尽可能提取后端返回的详细错误信息\n      // error.response：后端有响应（例如 400/401/500 等）\n      // error.request：请求发出但未收到响应（网络/跨域/后端未启动）\n      // error.message：Axios/JS 层面的错误消息\n      let detailedMessage = 'Login failed. Please check your credentials or server status.';\n\n      if (error?.response) {\n        const status: number = error.response.status;\n        const data = error.response.data;\n\n        // 尝试从后端响应体中提取错误信息字段\n        const serverMsg = typeof data === 'string'\n          ? data\n          : (data?.message || data?.error || data?.detail || '');\n\n        if (status === 401) {\n          detailedMessage = serverMsg || 'Invalid username or password.';\n        } else if (status === 400) {\n          detailedMessage = serverMsg || 'Bad request. Please verify the input format.';\n        } else if (status >= 500) {\n          detailedMessage = serverMsg || 'Server error. Please try again later.';\n        } else {\n          detailedMessage = serverMsg || `Request failed with status ${status}.`;\n        }\n      } else if (error?.request) {\n        // 请求已发出但没有收到响应（大多是网络问题或后端未启动/地址不对）\n        detailedMessage = 'Unable to reach the server. Please confirm the backend is running and NEXT_PUBLIC_API_BASE_URL is correct.';\n      } else if (error?.message) {\n        // 其他 Axios/JS 层面错误\n        detailedMessage = error.message;\n      }\n\n      return { success: false, message: detailedMessage };\n    }\n  }\n\n  /**\n   * Register a new user by calling the backend signup API.\n   *\n   * What it does:\n   * - Sends a POST request to `${API_BASE_URL}/auth/signup` with { username, email, password }.\n   * - Expects the backend to return a `UserResponseDto` (id, username, email, roles, ...).\n   * - Maps backend roles (e.g., ROLE_ADMIN/ROLE_OPERATOR/ROLE_USER) to our app roles\n   *   ('admin' | 'operator' | 'viewer'), and prepares a `User` object for UI feedback.\n   * - Does NOT log the user in automatically; the caller should redirect to the login page.\n   *\n   * Error handling:\n   * - Provides detailed error messages based on HTTP status codes and server response body.\n   * - Common cases: 400 (validation), 409 (conflict), 500 (server errors).\n   *\n   * Returns: { success, message, user? }\n   */\n  static async register(payload: { username: string; email: string; password: string; roles?: string[] }): Promise<{ success: boolean; message: string; user?: User }> {\n    try {\n      const res = await axios.post(`${API_BASE_URL}/auth/signup`, payload, {\n        headers: { 'Content-Type': 'application/json' }\n      });\n\n      const data: any = res.data || {};\n      const rolesFromServer: string[] = Array.isArray(data.roles) ? data.roles : [];\n\n      const mappedRole: 'admin' | 'operator' | 'viewer' =\n        rolesFromServer.includes('ROLE_ADMIN') ? 'admin' :\n        rolesFromServer.includes('ROLE_OPERATOR') ? 'operator' :\n        'viewer';\n\n      const user: User = {\n        id: String(data.id ?? ''),\n        username: data.username ?? payload.username,\n        name: data.username ?? payload.username,\n        email: data.email ?? payload.email,\n        role: mappedRole,\n        permissions: ROLE_PERMISSIONS[mappedRole]\n      };\n\n      // 这里不进行自动登录，也不保存 token；注册后通常需要用户主动登录\n      return { success: true, message: 'Registration successful! Please sign in.', user };\n    } catch (error: any) {\n      let detailedMessage = 'Registration failed. Please try again later.';\n\n      if (error?.response) {\n        const status: number = error.response.status;\n        const data = error.response.data;\n        const serverMsg = typeof data === 'string'\n          ? data\n          : (data?.message || data?.error || data?.detail || '');\n\n        if (status === 400) {\n          detailedMessage = serverMsg || 'Invalid input. Please check your username, email, and password.';\n        // } else if (status === 409) {\n        //   detailedMessage = serverMsg || 'User already exists. Try a different username or email.';\n        // } else if (status >= 500) {\n        //   detailedMessage = serverMsg || 'Server error. Please try again later.';\n        // } \n        }else {\n          detailedMessage = serverMsg || `Request failed with status ${status}.`;\n        }\n      } else if (error?.request) {\n        detailedMessage = 'Unable to reach the server. Please ensure the backend is running on the correct URL.';\n      } else if (error?.message) {\n        detailedMessage = error.message;\n      }\n\n      return { success: false, message: detailedMessage };\n    }\n  }\n\n  // Logout\n  static logout(): void {\n    this.removeToken();\n    // Redirect to login page\n    if (typeof window !== 'undefined') {\n      window.location.href = '/auth/login';\n    }\n  }\n\n  // Generate mock JWT token\n  private static generateMockToken(role: string): string {\n    const header = btoa(JSON.stringify({ alg: 'HS256', typ: 'JWT' }));\n    const payload = btoa(JSON.stringify({\n      sub: role === 'admin' ? '1' : '2',\n      name: role === 'admin' ? 'Administrator' : 'System Operator',\n      role: role,\n      iat: Math.floor(Date.now() / 1000),\n      exp: Math.floor(Date.now() / 1000) + (24 * 60 * 60) // 24 hours\n    }));\n    const signature = btoa('mock-signature');\n    \n    return `${header}.${payload}.${signature}`;\n  }\n}\n\n// Permission checking utilities\nexport class PermissionManager {\n  // Check if user has specific permission\n  static hasPermission(permission: string, user?: User | null): boolean {\n    if (!user) {\n      const currentUser = AuthManager.getUser();\n      if (!currentUser) return false;\n      user = currentUser;\n    }\n    \n    return user.permissions.includes(permission);\n  }\n\n  // Check if user has any of the specified permissions\n  static hasAnyPermission(permissions: string[], user?: User | null): boolean {\n    return permissions.some(permission => this.hasPermission(permission, user));\n  }\n\n  // Check if user has all specified permissions\n  static hasAllPermissions(permissions: string[], user?: User | null): boolean {\n    return permissions.every(permission => this.hasPermission(permission, user));\n  }\n\n  // Check if user has specific role\n  static hasRole(role: string, user?: User | null): boolean {\n    if (!user) {\n      const currentUser = AuthManager.getUser();\n      if (!currentUser) return false;\n      user = currentUser;\n    }\n    \n    return user.role === role;\n  }\n\n  // Check if user has minimum role level\n  static hasMinimumRole(minRole: 'viewer' | 'operator' | 'admin', user?: User | null): boolean {\n    if (!user) {\n      const currentUser = AuthManager.getUser();\n      if (!currentUser) return false;\n      user = currentUser;\n    }\n    \n    const roleHierarchy = { viewer: 1, operator: 2, admin: 3 };\n    const userLevel = roleHierarchy[user.role];\n    const minLevel = roleHierarchy[minRole];\n    \n    return userLevel >= minLevel;\n  }\n}\n\n// Route protection utilities\nexport const requireAuth = () => {\n  if (typeof window === 'undefined') return true;\n  \n  if (!AuthManager.isAuthenticated()) {\n    window.location.href = '/auth/login';\n    return false;\n  }\n  \n  return true;\n};\n\nexport const requirePermission = (permission: string) => {\n  if (!requireAuth()) return false;\n  \n  if (!PermissionManager.hasPermission(permission)) {\n    // Redirect to unauthorized page or show error\n    console.error(`Access denied: Missing permission '${permission}'`);\n    return false;\n  }\n  \n  return true;\n};\n\nexport const requireRole = (role: string) => {\n  if (!requireAuth()) return false;\n  \n  if (!PermissionManager.hasRole(role)) {\n    console.error(`Access denied: Required role '${role}'`);\n    return false;\n  }\n  \n  return true;\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 475, "column": 0}, "map": {"version":3,"sources":["file:///Users/a99/localDocuments/codeBase/ideaWorkplace/reacttest/frontend/src/components/Authentication/LoginForm.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport { Form, Input, Button, Card, message, Checkbox, Divider } from 'antd';\nimport { UserOutlined, LockOutlined, EyeInvisibleOutlined, EyeTwoTone } from '@ant-design/icons';\nimport Link from 'next/link';\nimport { AuthManager } from '@/lib/auth';\n\ninterface LoginFormData {\n  username: string;\n  password: string;\n  remember: boolean;\n}\n\ninterface LoginFormProps {\n  onLogin?: (data: LoginFormData) => void;\n  loading?: boolean;\n}\n\nconst LoginForm: React.FC<LoginFormProps> = ({ onLogin, loading = false }) => {\n  const [form] = Form.useForm();\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleSubmit = async (values: LoginFormData) => {\n    setIsLoading(true);\n    try {\n      const result = await AuthManager.login(values.username, values.password);\n      \n      if (result.success) {\n        message.success('Login successful!');\n        \n        if (onLogin) {\n          onLogin(values);\n        }\n        \n        // Redirect to main page\n        window.location.href = '/';\n      } else {\n        message.error(result.message);\n      }\n    } catch (error) {\n      message.error('Login failed. Please try again.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div>\n\n        <Form\n          form={form}\n          name=\"login\"\n          onFinish={handleSubmit}\n          autoComplete=\"off\"\n          size=\"large\"\n        >\n          <Form.Item\n            name=\"username\"\n            rules={[\n              { required: true, message: 'Please input your username!' },\n              { min: 3, message: 'Username must be at least 3 characters!' }\n            ]}\n          >\n            <Input \n              prefix={<UserOutlined />} \n              placeholder=\"Username\" \n            />\n          </Form.Item>\n\n          <Form.Item\n            name=\"password\"\n            rules={[\n              { required: true, message: 'Please input your password!' },\n              { min: 6, message: 'Password must be at least 6 characters!' }\n            ]}\n          >\n            <Input.Password\n              prefix={<LockOutlined />}\n              placeholder=\"Password\"\n              iconRender={(visible) => (visible ? <EyeTwoTone /> : <EyeInvisibleOutlined />)}\n            />\n          </Form.Item>\n\n          <Form.Item>\n            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n              <Form.Item name=\"remember\" valuePropName=\"checked\" noStyle>\n                <Checkbox>Remember me</Checkbox>\n              </Form.Item>\n              <Link href=\"/auth/forgot-password\" style={{ color: '#1890ff' }}>\n                Forgot password?\n              </Link>\n            </div>\n          </Form.Item>\n\n          <Form.Item>\n            <Button \n              type=\"primary\" \n              htmlType=\"submit\" \n              loading={isLoading || loading}\n              style={{ width: '100%', height: '40px' }}\n            >\n              Sign In\n            </Button>\n          </Form.Item>\n\n          <Divider>Or</Divider>\n\n          <div style={{ textAlign: 'center' }}>\n            <span style={{ color: '#666' }}>Don't have an account? </span>\n            <Link href=\"/auth/register\" style={{ color: '#1890ff', fontWeight: 'medium' }}>\n              Sign up now\n            </Link>\n          </div>\n        </Form>\n\n        <div style={{ marginTop: '24px', textAlign: 'center', fontSize: '12px', color: '#999' }}>\n          <p>Demo Mode: Enter any username and password to login</p>\n        </div>\n    </div>\n  );\n};\n\nexport default LoginForm;"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AANA;;;;;;;AAmBA,MAAM,YAAsC,CAAC,EAAE,OAAO,EAAE,UAAU,KAAK,EAAE;IACvE,MAAM,CAAC,KAAK,GAAG,sLAAI,CAAC,OAAO;IAC3B,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAE3C,MAAM,eAAe,OAAO;QAC1B,aAAa;QACb,IAAI;YACF,MAAM,SAAS,MAAM,iIAAW,CAAC,KAAK,CAAC,OAAO,QAAQ,EAAE,OAAO,QAAQ;YAEvE,IAAI,OAAO,OAAO,EAAE;gBAClB,+LAAO,CAAC,OAAO,CAAC;gBAEhB,IAAI,SAAS;oBACX,QAAQ;gBACV;gBAEA,wBAAwB;gBACxB,OAAO,QAAQ,CAAC,IAAI,GAAG;YACzB,OAAO;gBACL,+LAAO,CAAC,KAAK,CAAC,OAAO,OAAO;YAC9B;QACF,EAAE,OAAO,OAAO;YACd,+LAAO,CAAC,KAAK,CAAC;QAChB,SAAU;YACR,aAAa;QACf;IACF;IAEA,qBACE,8OAAC;;0BAEG,8OAAC,sLAAI;gBACH,MAAM;gBACN,MAAK;gBACL,UAAU;gBACV,cAAa;gBACb,MAAK;;kCAEL,8OAAC,sLAAI,CAAC,IAAI;wBACR,MAAK;wBACL,OAAO;4BACL;gCAAE,UAAU;gCAAM,SAAS;4BAA8B;4BACzD;gCAAE,KAAK;gCAAG,SAAS;4BAA0C;yBAC9D;kCAED,cAAA,8OAAC,yLAAK;4BACJ,sBAAQ,8OAAC,kOAAY;;;;;4BACrB,aAAY;;;;;;;;;;;kCAIhB,8OAAC,sLAAI,CAAC,IAAI;wBACR,MAAK;wBACL,OAAO;4BACL;gCAAE,UAAU;gCAAM,SAAS;4BAA8B;4BACzD;gCAAE,KAAK;gCAAG,SAAS;4BAA0C;yBAC9D;kCAED,cAAA,8OAAC,yLAAK,CAAC,QAAQ;4BACb,sBAAQ,8OAAC,kOAAY;;;;;4BACrB,aAAY;4BACZ,YAAY,CAAC,UAAa,wBAAU,8OAAC,4NAAU;;;;2DAAM,8OAAC,0PAAoB;;;;;;;;;;;;;;;kCAI9E,8OAAC,sLAAI,CAAC,IAAI;kCACR,cAAA,8OAAC;4BAAI,OAAO;gCAAE,SAAS;gCAAQ,gBAAgB;gCAAiB,YAAY;4BAAS;;8CACnF,8OAAC,sLAAI,CAAC,IAAI;oCAAC,MAAK;oCAAW,eAAc;oCAAU,OAAO;8CACxD,cAAA,8OAAC,kMAAQ;kDAAC;;;;;;;;;;;8CAEZ,8OAAC,uKAAI;oCAAC,MAAK;oCAAwB,OAAO;wCAAE,OAAO;oCAAU;8CAAG;;;;;;;;;;;;;;;;;kCAMpE,8OAAC,sLAAI,CAAC,IAAI;kCACR,cAAA,8OAAC,4MAAM;4BACL,MAAK;4BACL,UAAS;4BACT,SAAS,aAAa;4BACtB,OAAO;gCAAE,OAAO;gCAAQ,QAAQ;4BAAO;sCACxC;;;;;;;;;;;kCAKH,8OAAC,+LAAO;kCAAC;;;;;;kCAET,8OAAC;wBAAI,OAAO;4BAAE,WAAW;wBAAS;;0CAChC,8OAAC;gCAAK,OAAO;oCAAE,OAAO;gCAAO;0CAAG;;;;;;0CAChC,8OAAC,uKAAI;gCAAC,MAAK;gCAAiB,OAAO;oCAAE,OAAO;oCAAW,YAAY;gCAAS;0CAAG;;;;;;;;;;;;;;;;;;0BAMnF,8OAAC;gBAAI,OAAO;oBAAE,WAAW;oBAAQ,WAAW;oBAAU,UAAU;oBAAQ,OAAO;gBAAO;0BACpF,cAAA,8OAAC;8BAAE;;;;;;;;;;;;;;;;;AAIb;uCAEe","debugId":null}},
    {"offset": {"line": 742, "column": 0}, "map": {"version":3,"sources":["file:///Users/a99/localDocuments/codeBase/ideaWorkplace/reacttest/frontend/src/app/auth/login/page.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Card, Row, Col } from 'antd';\nimport { AuthManager } from '@/lib/auth';\nimport LoginForm from '@/components/Authentication/LoginForm';\n\nconst LoginPage: React.FC = () => {\n  const router = useRouter();\n\n  useEffect(() => {\n    // Redirect if already authenticated\n    if (AuthManager.isAuthenticated()) {\n      router.push('/');\n    }\n  }, [router]);\n\n  return (\n    <div style={{\n      minHeight: '100vh',\n      background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      padding: '20px'\n    }}>\n      <Row justify=\"center\" style={{ width: '100%' }}>\n        <Col xs={20} sm={16} md={12} lg={8} xl={6}>\n          <Card\n            style={{\n              boxShadow: '0 8px 32px rgba(0, 0, 0, 0.1)',\n              borderRadius: '12px',\n              border: 'none'\n            }}\n            styles={{ body: { padding: '32px' } }}\n          >\n            <div style={{ textAlign: 'center', marginBottom: '30px' }}>\n              <h1 style={{ \n                fontSize: '28px', \n                fontWeight: 'bold', \n                color: '#1f2937',\n                marginBottom: '8px'\n              }}>\n                Host Management System\n              </h1>\n              <p style={{ \n                color: '#6b7280', \n                fontSize: '16px',\n                margin: 0\n              }}>\n                Sign in to your account\n              </p>\n            </div>\n            \n            <LoginForm />\n          </Card>\n        </Col>\n      </Row>\n    </div>\n  );\n};\n\nexport default LoginPage;"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AANA;;;;;;;AAQA,MAAM,YAAsB;IAC1B,MAAM,SAAS,IAAA,+IAAS;IAExB,IAAA,kNAAS,EAAC;QACR,oCAAoC;QACpC,IAAI,iIAAW,CAAC,eAAe,IAAI;YACjC,OAAO,IAAI,CAAC;QACd;IACF,GAAG;QAAC;KAAO;IAEX,qBACE,8OAAC;QAAI,OAAO;YACV,WAAW;YACX,YAAY;YACZ,SAAS;YACT,YAAY;YACZ,gBAAgB;YAChB,SAAS;QACX;kBACE,cAAA,8OAAC,mLAAG;YAAC,SAAQ;YAAS,OAAO;gBAAE,OAAO;YAAO;sBAC3C,cAAA,8OAAC,mLAAG;gBAAC,IAAI;gBAAI,IAAI;gBAAI,IAAI;gBAAI,IAAI;gBAAG,IAAI;0BACtC,cAAA,8OAAC,sLAAI;oBACH,OAAO;wBACL,WAAW;wBACX,cAAc;wBACd,QAAQ;oBACV;oBACA,QAAQ;wBAAE,MAAM;4BAAE,SAAS;wBAAO;oBAAE;;sCAEpC,8OAAC;4BAAI,OAAO;gCAAE,WAAW;gCAAU,cAAc;4BAAO;;8CACtD,8OAAC;oCAAG,OAAO;wCACT,UAAU;wCACV,YAAY;wCACZ,OAAO;wCACP,cAAc;oCAChB;8CAAG;;;;;;8CAGH,8OAAC;oCAAE,OAAO;wCACR,OAAO;wCACP,UAAU;wCACV,QAAQ;oCACV;8CAAG;;;;;;;;;;;;sCAKL,8OAAC,4JAAS;;;;;;;;;;;;;;;;;;;;;;;;;;AAMtB;uCAEe","debugId":null}}]
}